<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cqupt.software_9.mapper.AdminDataManageMapper">

    <!--void createTable(@Param("headers") String[] headers,@Param("tableName") String tableName);
        void uploadDataTable(AdminDataManage dataTable);-->
    <update id="createTable">
        create table ${tableName} (
        <foreach collection="headers" item="columnName" separator=",">
            ${columnName} VARCHAR(255)
        </foreach>
        );
    </update>
    <insert id="insertRow">
        INSERT INTO ${tableName}
        VALUES
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <foreach collection="row" item="value">
                #{value},
            </foreach>
        </trim>
    </insert>


    <!-- List<AdminDataManage> selectAllDataInfo();-->
    <select id="selectAllDataInfo" resultType="com.cqupt.software_9.entity.AdminDataManage">
--         SELECT id, tableName, createUser, createTime, classPath, tableStatus, tableSize FROM software10.table_describe;
        SELECT id, table_id, table_name, create_user, create_time, class_path, table_status, table_size FROM software10.table_describe;
    </select>
<!--    List<AdminDataManage> selectDataByTableName(String tableName);-->
    <select id="selectDataByTableName" resultType="com.cqupt.software_9.entity.AdminDataManage">
        SELECT id, table_id, table_name, create_user, create_time, class_path, table_status, table_size
        FROM software10.table_describe
        where table_name = #{tableName}
    </select>
<!--    List<AdminDataManage> selectDataByUserName(String userName);-->
    <select id="selectDataByUserName" resultType="com.cqupt.software_9.entity.AdminDataManage">
        SELECT id, table_id, table_name, create_user, create_time, class_path, table_status, table_size
        FROM software10.table_describe
        where create_user = #{userName}
    </select>
<!--    List<AdminDataManage> selectDataByDiseaseName(String diseaseName);-->
    <select id="selectDataByDiseaseName" resultType="com.cqupt.software_9.entity.AdminDataManage">
        SELECT id, table_id, table_name, create_user, create_time, class_path, table_status, table_size
        FROM software10.table_describe
        WHERE class_path LIKE CONCAT('%', #{diseaseName}, '%')
    </select>

    <!-- void deleteByTableName(String tablename);-->

    <!--void updateById(String id);-->
    <update id="updateById" >
        update software10.table_describe
        set table_name=#{tableName},
            table_status=#{tableStatus}
        where id = CAST(#{id} AS VARCHAR);;
    </update>

    <!-- 删除表的SQL语句 -->
    <delete id="deleteByTableName">
        DROP TABLE IF EXISTS ${tableName};
    </delete>

</mapper>
