<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.cqupt.software_9.mapper.modelResultMapper">


    <delete id="removeModelResult">
        DELETE FROM modelresult
        <where>
            <if test="modelname != null and modelname != ''">
                AND modelname LIKE CONCAT(#{modelname}, '%')
            </if>
        </where>
    </delete>
    <select id="getModelDetail" resultType="com.cqupt.software_9.entity.modelResult">
        SELECT *
        FROM modelresult
        <where>
            <if test="modelname != null and modelname != ''">
                AND modelname LIKE CONCAT(#{modelname}, '%')
            </if>
        </where>
    </select>

    <select id="getTableName" resultType="java.util.Map">
        SELECT DISTINCT diseasename,  SPLIT_PART(modelname, '-', 1) AS  modelname FROM modelresult
    </select>


    <select id="getModelResultAndModel" resultType="com.cqupt.software_9.common.modelAndModelResultDTO">
        SELECT * FROM (SELECT modelresult.modelname,modelresult.evaluate,modelresult.pkl,modelresult.uid,modelresult.al,modelresult.tablename,
                              model.diseasename,model.createtime,model.publisher,model.feature
                       FROM modelresult
                                JOIN model ON modelresult.modelname = model.modelname)
        WHERE modelname = #{modelname}
    </select>
    <select id="getTableNamePre" resultType="java.util.Map">
        SELECT DISTINCT diseasename, modelname AS  modelname FROM modelresult
    </select>


    <select id="getPicture" resultType="java.lang.String">
        SELECT picture FROM modelresult WHERE modelname LIKE CONCAT(#{modelname}, '%')
    </select>
    <select id="getPKL" resultType="java.lang.String">
        SELECT PKL FROM modelresult WHERE modelname LIKE CONCAT(#{modelname}, '%')
    </select>
    <select id="getAllPKL" resultType="java.lang.String">
        SELECT PKL FROM modelresult
    </select>
    <select id="getAllPicture" resultType="java.lang.String">
        SELECT picture FROM modelresult
    </select>


</mapper>

